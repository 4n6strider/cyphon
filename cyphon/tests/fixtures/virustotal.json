[
  {
    "model": "suppliers.supplier",
    "fields": {
      "name": "virustotal",
      "enabled": true
    }
  },
  {
    "model": "passports.passport",
    "fields": {
      "name": "VirusTotal Public",
      "key": "1094517f822994bd99e86887f97f4a504092c81e9aefb29cb69f1dd91699022f",
      "secret": "",
      "access_token": "",
      "access_token_secret": "",
      "public": true,
      "users": []
    }
  },
  {
    "model": "visas.visa",
    "fields": {
      "name": "VirusTotal API",
      "calls": 4,
      "time_interval": 1,
      "time_unit": "m"
    }
  },
  {
    "model": "requisitions.requisition",
    "fields": {
      "platform": ["virustotal"],
      "api_module": "handlers",
      "api_class": "UrlScan"
    }
  },
  {
    "model": "requisitions.requisition",
    "fields": {
      "platform": ["virustotal"],
      "api_module": "handlers",
      "api_class": "UrlReport"
    }
  },
  {
    "model": "requisitions.parameter",
    "fields": {
      "requisition": ["virustotal", "UrlReport"],
      "param_name": "resource",
      "param_type": "CharField"
    }
  },
  {
    "model": "requisitions.parameter",
    "fields": {
      "requisition": ["virustotal", "UrlScan"],
      "param_name": "url",
      "param_type": "CharField"
    }
  },
  {
    "model": "quartermasters.quartermaster",
    "fields": {
      "name": "virustotal_filescan_1",
      "endpoints": [["virustotal", "UrlReport"], ["virustotal", "UrlScan"]],
      "passport": ["VirusTotal Public"],
      "visa": ["VirusTotal API"]
    }
  },
  {
    "model": "supplychains.supplychain",
    "fields": {
      "name": "VirusTotal URL Report"
    }
  },
  {
    "model": "supplychains.supplylink",
    "fields": {
      "name": "VirusTotal URL Report",
      "supply_chain": ["VirusTotal URL Report"],
      "requisition": ["virustotal", "UrlReport"],
      "position": 0,
      "wait_time": 0,
      "time_unit": "m"
    }
  },
  {
    "model": "supplychains.fieldcoupling",
    "fields": {
      "supply_link": ["VirusTotal URL Report"],
      "parameter": ["virustotal", "UrlReport", "resource"],
      "field_name": "url"
    }
  },
  {
    "model": "supplychains.supplychain",
    "fields": {
      "name": "VirusTotal URL Scan & Report"
    }
  },
  {
    "model": "supplychains.supplylink",
    "fields": {
      "name": "VirusTotal URL Scan",
      "supply_chain": ["VirusTotal URL Scan & Report"],
      "requisition": ["virustotal", "UrlScan"],
      "position": 0,
      "wait_time": 0,
      "time_unit": "m"
    }
  },
  {
    "model": "supplychains.fieldcoupling",
    "fields": {
      "supply_link": ["VirusTotal URL Scan"],
      "parameter": ["virustotal", "UrlScan", "url"],
      "field_name": "url"
    }
  },
  {
    "model": "supplychains.supplylink",
    "fields": {
      "name": "VirusTotal URL Report after 30s wait",
      "supply_chain": ["VirusTotal URL Scan & Report"],
      "requisition": ["virustotal", "UrlReport"],
      "position": 1,
      "wait_time": 30,
      "time_unit": "s"
    }
  },
  {
    "model": "supplychains.fieldcoupling",
    "fields": {
      "supply_link": ["VirusTotal URL Report after 30s wait"],
      "parameter": ["virustotal", "UrlReport", "resource"],
      "field_name": "url"
    }
  }
]
